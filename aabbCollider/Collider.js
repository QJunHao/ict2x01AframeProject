!function(e){function t(i){if(s[i])return s[i].exports;var n=s[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var s={};return t.m=e,t.c=s,t.p="",t(0)}([function(e,t){function s(e,t){var s;for(e.length=0,s=0;s<t.length;s++)e[s]=t[s]}if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");var i={childList:!0,attributes:!0,subtree:!0};AFRAME.registerComponent("aabb-collider",{schema:{collideNonVisible:{default:!1},debug:{default:!1},enabled:{default:!0},interval:{default:80},objects:{default:""}},init:function(){this.centerDifferenceVec3=new THREE.Vector3,this.clearedIntersectedEls=[],this.closestIntersectedEl=null,this.boundingBox=new THREE.Box3,this.boxCenter=new THREE.Vector3,this.boxHelper=new THREE.BoxHelper,this.boxMax=new THREE.Vector3,this.boxMin=new THREE.Vector3,this.hitClosestClearEventDetail={},this.hitClosestEventDetail={},this.intersectedEls=[],this.objectEls=[],this.newIntersectedEls=[],this.prevCheckTime=void 0,this.previousIntersectedEls=[],this.setDirty=this.setDirty.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.hitStartEventDetail={intersectedEls:this.newIntersectedEls}},play:function(){this.observer.observe(this.el.sceneEl,i),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty)},remove:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},tick:function(e){var t,i,n,r,l,o=this.boundingBox,h=this.centerDifferenceVec3,c=this.clearedIntersectedEls,a=this.intersectedEls,d=this.el,b=this.newIntersectedEls,E=this.objectEls,x=this.prevCheckTime,u=this.previousIntersectedEls;if(this.data.enabled&&!(x&&e-x<this.data.interval)&&(this.prevCheckTime=e,l=d.getObject3D("mesh")||d.getObject3D("text"))){for(this.dirty&&this.refreshObjects(),o.setFromObject(l),this.boxMin.copy(o.min),this.boxMax.copy(o.max),o.getCenter(this.boxCenter),this.data.debug&&(this.boxHelper.setFromObject(l),this.boxHelper.parent||d.sceneEl.object3D.add(this.boxHelper)),s(u,a),a.length=0,r=0;r<E.length;r++)this.data.collideNonVisible||E[r].getAttribute("visible")?this.isIntersecting(E[r])&&a.push(E[r]):this.data.debug&&(t=E[r].getObject3D("mesh").boxHelper,t&&(d.sceneEl.object3D.remove(t),E[r].getObject3D("mesh").boxHelper=null));for(b.length=0,r=0;r<a.length;r++)u.indexOf(a[r])===-1&&b.push(a[r]);for(c.length=0,r=0;r<u.length;r++)a.indexOf(u[r])===-1&&(u[r].hasAttribute("aabb-collider")||u[r].emit("hitend"),c.push(u[r]));for(r=0;r<b.length;r++)b[r].hasAttribute("aabb-collider")||b[r].emit("hitstart");for(r=0;r<a.length;r++)h.copy(a[r].getObject3D("mesh").boundingBoxCenter).sub(this.boxCenter),(void 0===i||h.length()<i)&&(i=h.length(),n=a[r]);!a.length&&this.closestIntersectedEl?(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit("hitclosestclear"),this.closestIntersectedEl=null,d.emit("hitclosestclear",this.hitClosestClearEventDetail)):n!==this.closestIntersectedEl&&(this.closestIntersectedEl&&(this.hitClosestClearEventDetail.el=this.closestIntersectedEl,this.closestIntersectedEl.emit("hitclosestclear",this.hitClosestClearEventDetail)),n&&(n.emit("hitclosest"),this.closestIntersectedEl=n,this.hitClosestEventDetail.el=n,d.emit("hitclosest",this.hitClosestEventDetail))),c.length&&d.emit("hitend"),b.length&&d.emit("hitstart",this.hitStartEventDetail)}},isIntersecting:function(){var e=new THREE.Box3;return function(t){var s,i,n;if(s=t.getObject3D("mesh")||t.getObject3D("text"))return e.setFromObject(s),this.data.debug&&(s.boxHelper||(s.boxHelper=new THREE.BoxHelper(s,new THREE.Color(Math.random(),Math.random(),Math.random())),t.sceneEl.object3D.add(s.boxHelper)),s.boxHelper.setFromObject(s)),i=e.min,n=e.max,s.boundingBoxCenter=s.boundingBoxCenter||new THREE.Vector3,e.getCenter(s.boundingBoxCenter),this.boxMin.x<=n.x&&this.boxMax.x>=i.x&&this.boxMin.y<=n.y&&this.boxMax.y>=i.y&&this.boxMin.z<=n.z&&this.boxMax.z>=i.z}}(),setDirty:function(){this.dirty=!0},refreshObjects:function(){var e=this.data;this.objectEls=e.objects?this.el.sceneEl.querySelectorAll(e.objects):this.el.sceneEl.children,this.dirty=!1}})}]);